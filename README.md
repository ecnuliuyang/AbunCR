# CRAbun
This package aims to show how to implement empirical likelihood (EL) methods under the Huggin-Alho model in capture recapture studies.
As an example, we analyze a real data to show how to reproduce the results of Table 3 in Liu et al. (2020+).

## Instruction about CRAbun package
### 1. A Data set named "prinia"
This dataset is composed of 6 columns:
- id: unique identifier.
- number.of.capture: number of times an individual is captured.
- tail.length: individual covariate (50mm~91.25mm) with 41 missing records.
- fat.index: 0 (nonfat) and 1 (fat), 
which respectively corresponds to level 1 and level 2-4 in original data.
- wing: individual covariate (43mm~49mm).
- wing.cut: 0 (normal length) and 1 (long length), where "normal" means that the wing length ranges from 37mm to 45.5mm
and "long" means that the wing length is larger than 45.5mm.

### 2. Optimization algorithm for EL methods
To obtain the maximum EL estimator and the EL ratio confidence interval of the abundance *N*, 
we provide two functions:
- el.opt: used in the absence of missing data. Refer to Liu et al. (2017).
- el.opt.miss: used in the presence of missing data. Refer to Liu et al. (2019+).

### 3. Other functions
To compare the performance of the proposed EL methods and the existing 
inverse probability weighting (IPW) and multiple impution (MI) methods
proposed by Lee et al. (2016),
we give two functions:
- ipw.miss: used to implement the IPW method.
- mi2.miss: used to implement the MI method.

## Comments
1. The ipw.miss function and mi2.miss function are specific to the prinia data with three variables 
(fat.index, wing.cut and tail.length) in the model.
2. Whenever there is missing data or not, el.opt function and el.opt.miss function 
are almost always feasible to calculate the maximum EL estimate and EL ratio confidence interval.
3. In the presence of missing data, the standard error generated by el.opt.miss function is only for prinia data.
When using this function, care must be taken to modify the code that calculates standard error.

## References

Lee, S.-M., W.-H. Hwang, and J. de Dieu Tapsoba (2016). 
Estimation in closed captureâ€“recapture models when covariates are missing at random. 
*Biometrics* **72**(4), 1294--1304.as

Liu, Y., P. Li, and J. Qin (2017). 
Maximum empirical likelihood estimation for abundance in a closed
population from capture-recapture data. 
*Biometrika* **104**(3), 527--543.

Liu, Y., Y. Liu, P. Li, and L. Zhu (2020+).
Maximum likelihood abundance estimation from capture-recapture data when covariates are missing at random.
Submitted.

## Contact
Yang Liu, liuyangecnu@163.com
